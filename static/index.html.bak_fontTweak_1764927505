<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Dual AI Console ‚Äî Cem Edition</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #0b1220;
      color: #e5e7eb;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      padding: 10px 16px;
      border-bottom: 1px solid #1f2937;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(to right, #0b1220, #111827);
    }
    header h1 {
      font-size: 16px;
      margin: 0;
    }
    header span {
      font-size: 12px;
      color: #9ca3af;
    }
    main {
      flex: 1;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0;
      overflow: hidden;
    }
    .panel {
      display: flex;
      flex-direction: column;
      border-left: 1px solid #1f2937;
    }
    .panel:first-child {
      border-left: none;
      border-right: 1px solid #1f2937;
    }
    .panel-header {
      padding: 8px 12px;
      border-bottom: 1px solid #1f2937;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #020617;
    }
    .panel-header h2 {
      font-size: 14px;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .badge {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 999px;
      background: #111827;
      color: #9ca3af;
    }
    .body {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 8px;
      gap: 8px;
      overflow: hidden;
    }
    textarea {
      width: 100%;
      resize: none;
      min-height: 80px;
      border-radius: 8px;
      border: 1px solid #374151;
      background: #020617;
      color: #e5e7eb;
      padding: 8px;
      font-size: 13px;
      font-family: inherit;
    }
    textarea:focus {
      outline: 1px solid #f97316;
      border-color: #f97316;
    }
    .output {
      flex: 1;
      border-radius: 8px;
      border: 1px solid #1f2937;
      background: #020617;
      padding: 8px;
      font-size: 13px;
      overflow-y: auto;
      white-space: pre-wrap;
    }
    .controls {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 11px;
    }
    button {
      border-radius: 999px;
      border: none;
      padding: 6px 12px;
      font-size: 12px;
      cursor: pointer;
      background: #f97316;
      color: #111827;
      font-weight: 500;
    }
    button:disabled {
      opacity: 0.6;
      cursor: default;
    }
    select {
      background: #020617;
      color: #e5e7eb;
      border-radius: 999px;
      border: 1px solid #374151;
      padding: 4px 8px;
      font-size: 11px;
    }
    input[type="file"] {
      font-size: 10px;
      color: #9ca3af;
    }
    .usage {
      color: #6b7280;
      font-size: 11px;
    }
    footer {
      padding: 4px 10px;
      font-size: 10px;
      color: #6b7280;
      border-top: 1px solid #1f2937;
      background: #020617;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
  </style>
<!-- WHITE THEME PATCH START -->
<style>
  body { background:#ffffff !important; color:#111111 !important; }
  .chat-column, .chat-panel, .chat-box {
    background:#ffffff !important; border:1px solid #e0e0e0 !important;
    border-radius:10px !important;
  }
  textarea, input[type=text], input[type=search] {
    background:#fafafa !important; color:#111 !important;
    border:1px solid #d0d0d0 !important; border-radius:8px !important;
  }
  header, nav, .navbar {
    background:#ffffff !important; border-bottom:1px solid #e5e5e5 !important;
  }
</style>
<!-- WHITE THEME PATCH END -->

<!-- WHITE THEME V2 PATCH -->
<style>
  body {
    background: #ffffff !important;
    color: #111111 !important;
    font-size: 16px;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
  }

  /* Ana iki panel + input/output alanlarƒ± */
  #openai-output, #anthropic-output,
  #openai-input, #anthropic-input,
  .chat-panel, .chat-column, .chat-box,
  .output-box, .input-box {
    background: #ffffff !important;
    color: #111111 !important;
    border-radius: 10px !important;
    border: 1px solid #e0e0e0 !important;
  }

  /* Textarea, pre, kod bloklarƒ± */
  textarea, pre, code {
    font-size: 16px !important;
    line-height: 1.5;
    background: #fafafa !important;
    color: #111111 !important;
    border-radius: 8px !important;
    border: 1px solid #d0d0d0 !important;
  }

  /* Butonlar daha okunaklƒ± dursun */
  button {
    font-size: 14px;
  }
</style>
<!-- /WHITE THEME V2 PATCH -->


<!-- WHITE THEME V3 PATCH -->
<style>
  /* Global font & colors */
  html, body {
    background: #ffffff !important;
    color: #111111 !important;
    font-size: 18px !important;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
  }

  /* B√ºt√ºn layout ve iki paneli zorla beyaz yap */
  .app-root, .main-layout, .dual-console, .chat-layout,
  .chat-columns, .chat-column, .chat-panel,
  .left-pane, .right-pane, .column-left, .column-right,
  #openai-panel, #anthropic-panel,
  #openai-output, #anthropic-output {
    background: #ffffff !important;
    color: #111111 !important;
    border-color: #e0e0e0 !important;
  }

  /* Mesaj kutularƒ±, textarea vs. */
  textarea, pre, code, .message, .chat-message, .output-box, .input-box {
    font-size: 17px !important;
    line-height: 1.55;
    background: #fafafa !important;
    color: #111111 !important;
    border-radius: 8px !important;
    border: 1px solid #d0d0d0 !important;
  }

  button {
    font-size: 15px !important;
  }
</style>
<!-- /WHITE THEME V3 PATCH -->


<!-- WHITE THEME V4 PATCH ‚Äì Nuclear Mode -->
<style>
  /* Global */
  html, body {
    background: #ffffff !important;
    color: #111111 !important;
    font-size: 18px !important;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
  }

  /* All wrappers, left + right panels */
  .container, .wrapper, .layout, .main-layout,
  .dual-console, .chat-container,
  .chat-columns, .chat-column,
  .left-panel, .right-panel,
  .column-left, .column-right,
  .left-pane, .right-pane,
  #openai-panel, #anthropic-panel,
  #openai-output, #anthropic-output {
      background: #ffffff !important;
      color: #111111 !important;
      border-color: #d0d0d0 !important;
  }

  /* Anything that looks like a chat box */
  textarea, pre, code, .message, .chat-message,
  .output-box, .input-box, .chat-output,
  .result-window, .response-box {
      background: #fafafa !important;
      color: #111 !important;
      font-size: 17px !important;
      line-height: 1.55;
      border: 1px solid #d0d0d0 !important;
      border-radius: 8px !important;
  }

  /* Catch-all: any div with dark background */
  div[style*="background:#0"], div[style*="background: #0"],
  div[style*="background-color:#0"], div[style*="background-color: #0"],
  div[style*="background:#1"], div[style*="background: #1"] {
      background: #ffffff !important;
      color: #111111 !important;
  }

</style>
<!-- END WHITE THEME V4 PATCH -->


<!-- WHITE THEME V5 ‚Äì ULTRA OVERRIDE -->
<style>
  /* SAƒû PANEL ƒ∞√áƒ∞N EVRENSEL BEYAZ TEMA */
  .right-panel, .right-pane, .column-right, #claude-panel, #anthropic-panel,
  .claude-container, .claude-column, .claude-side,
  [class*="right"], [id*="right"], [class*="anthropic"], [id*="anthropic"] {
      background: #ffffff !important;
      color: #111 !important;
  }

  /* SAƒû CHAT OUTPUT KUTULARI */
  #anthropic-output, #claude-output,
  .right-output, .claude-output, .output-box {
      background: #fafafa !important;
      color: #111 !important;
      font-size: 18px !important;
      border: 1px solid #ccc !important;
      border-radius: 8px !important;
      padding: 12px !important;
  }

  /* SAƒû PANELDE BULUNAN T√úM DIVLERƒ∞ BEYAZLA */
  #anthropic-panel div, #claude-panel div,
  .right-panel div, .column-right div {
      background-color: #ffffff !important;
      color: #111 !important;
  }

  /* Koyu arka plan i√ßeren her div‚Äôi yakala */
  div[style*="rgb(0"], div[style*="#0"], div[style*="#1"] {
      background: #ffffff !important;
      color: #111 !important;
  }
</style>
<!-- END WHITE THEME V5 -->


<!-- TYPOGRAPHY PATCH V1 -->
<style>
  /* Global font (Apple tarzƒ±, T√ºrk√ße karakter tam destek) */
  html, body {
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text",
                 "Helvetica Neue", system-ui, -system-ui, sans-serif;
    font-size: 18px !important;
    line-height: 1.6;
    color: #111111;
  }

  /* √ústteki prompt input alanlarƒ± */
  textarea,
  .prompt-input,
  .chat-input,
  .input-box {
    font-size: 18px !important;
    line-height: 1.6 !important;
  }

  /* Cevap alanlarƒ± (output) */
  #openai-output,
  #anthropic-output,
  .chat-output,
  .response-box,
  .output-box,
  pre,
  code {
    font-size: 18px !important;
    line-height: 1.7 !important;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text",
                 "Helvetica Neue", system-ui, -system-ui, sans-serif;
  }

  /* Butonlar ve k√º√ß√ºk metinler */
  button,
  .model-select,
  .token-info,
  .header-text,
  .badge {
    font-size: 15px !important;
  }

  /* Placeholder‚Äôlar da okunabilir olsun */
  textarea::placeholder,
  .prompt-input::placeholder {
    font-size: 16px;
    color: #777777;
  }
</style>
<!-- /TYPOGRAPHY PATCH V1 -->


<!-- TYPOGRAPHY PATCH V3 ‚Äî ULTRA READABLE -->
<style>
  /* GLOBAL */
  html, body {
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text",
                 "Helvetica Neue", system-ui, sans-serif !important;
    font-size: 22px !important;     /* üî• TEMEL BOYUT ARTTI */
    line-height: 1.75 !important;   /* Daha ferah */
    color: #111 !important;
  }

  /* INPUT + PROMPT ALANLARI */
  textarea,
  input,
  .prompt-input {
    font-size: 22px !important;      /* üî• 2 kat daha b√ºy√ºk */
    line-height: 1.7 !important;
    padding: 16px !important;
  }

  textarea::placeholder,
  .prompt-input::placeholder {
    font-size: 20px !important;
    color: #777 !important;
  }

  /* CEVAP ALANLARI (OUTPUT) */
  #openai-output,
  #anthropic-output,
  .chat-output,
  .response-box,
  .output-box,
  pre,
  code {
    font-size: 24px !important;     /* üî• Cevap metni b√ºy√ºk */
    line-height: 1.8 !important;
    white-space: pre-wrap !important;
    word-break: break-word !important;
    color: #111 !important;
  }

  /* BUTONLAR + SE√áƒ∞Cƒ∞LER */
  button,
  .model-select,
  .token-info,
  .badge {
    font-size: 18px !important;
    padding: 10px 16px !important;
  }
</style>
<!-- /TYPOGRAPHY PATCH V3 -->


<!-- TYPOGRAPHY PATCH V4 ‚Äî MAX READABLE UI -->
<style>
  /* Global base ‚Äì HER ≈ûEYƒ∞N TEMELƒ∞ */
  html, body {
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text",
                 "Helvetica Neue", system-ui, sans-serif !important;
    font-size: 26px !important;       /* üî• temel boyut b√ºy√ºt√ºld√º */
    line-height: 1.8 !important;
    color: #111111 !important;
  }

  /* √úst bar, men√ºler, nav */
  header, nav, nav * ,
  .top-bar, .top-bar * {
    font-size: 24px !important;
  }

  /* Ba≈ülƒ±klar */
  h1 { font-size: 32px !important; }
  h2 { font-size: 30px !important; }
  h3 { font-size: 28px !important; }

  /* Prompt input alanlarƒ± */
  textarea,
  input,
  .prompt-input,
  .chat-input {
    font-size: 28px !important;
    line-height: 1.8 !important;
    padding: 18px !important;
  }

  textarea::placeholder,
  .prompt-input::placeholder {
    font-size: 24px !important;
    color: #777 !important;
  }

  /* √áIKTI / CEVAP ALANLARI */
  #openai-output,
  #anthropic-output,
  .chat-output,
  .response-box,
  .output-box,
  pre,
  code {
    font-size: 28px !important;       /* üî• asƒ±l okuduƒüun yer */
    line-height: 1.9 !important;
    white-space: pre-wrap !important;
    word-break: break-word !important;
    color: #111 !important;
  }

  /* Butonlar, model se√ßici, token info vs. */
  button,
  .model-select,
  select,
  .token-info,
  .badge,
  .pill {
    font-size: 22px !important;
    padding: 10px 18px !important;
  }
</style>
<!-- /TYPOGRAPHY PATCH V4 -->


<!-- GLOBAL FONT OVERRIDE ‚Äî ChatGPT placeholder style x2 -->
<style>
  /* Ana font ‚Äî ChatGPT placeholder fontunun birebir aynƒ±sƒ± */
  :root {
    --base-font: -apple-system, BlinkMacSystemFont, "SF Pro Text",
                 "Helvetica Neue", Helvetica, Arial, sans-serif;
  }

  /* T√ºm UI‚Äônin temel fontu ‚Äî x2 b√ºy√ºtme */
  html, body {
    font-family: var(--base-font) !important;
    font-size: 32px !important;     /* üî• placeholder‚Äôƒ±n TAM 2X versiyonu */
    line-height: 1.9 !important;
    color: #111 !important;
  }

  /* Ba≈ülƒ±klar */
  h1 { font-size: 40px !important; font-weight: 600 !important; }
  h2 { font-size: 36px !important; font-weight: 600 !important; }
  h3 { font-size: 32px !important; font-weight: 500 !important; }

  /* Model se√ßici, nav, √ºst men√º */
  nav, nav *, header, header * {
    font-size: 28px !important;
    font-weight: 500 !important;
  }

  /* Textarea: placeholder stili x2 */
  textarea, .prompt-input {
    font-size: 32px !important;
    font-family: var(--base-font) !important;
    padding: 20px !important;
    line-height: 1.9 !important;
  }

  textarea::placeholder {
    font-size: 28px !important;
    color: #777 !important;
    font-family: var(--base-font) !important;
  }

  /* Cevap alanlarƒ± */
  #openai-output,
  #anthropic-output,
  .response-box,
  .output-box,
  pre, code {
    font-size: 32px !important;     /* üî• ana okuma alanƒ± */
    font-family: var(--base-font) !important;
    line-height: 1.9 !important;
    white-space: pre-wrap !important;
  }

  /* Butonlar */
  button {
    font-size: 26px !important;
    font-family: var(--base-font) !important;
    padding: 12px 22px !important;
  }
</style>
<!-- /GLOBAL FONT OVERRIDE -->


<!-- GLOBAL SUPER FONT OVERRIDE ‚Äî x2 Bigger Again -->
<style>
  :root {
    --base-font: -apple-system, BlinkMacSystemFont, "SF Pro Text",
                 "Helvetica Neue", Helvetica, Arial, sans-serif;
  }

  /* Ana body ‚Äî tekrar 2√ó b√ºy√ºtme */
  html, body {
    font-family: var(--base-font) !important;
    font-size: 52px !important;   /* üî• √ñnceki 26‚Äì32px seviyesinin TAM 2√ó */
    line-height: 1.9 !important;
    color: #111 !important;
  }

  /* HEADER ‚Äî √ßok daha b√ºy√ºk */
  header, nav, header *, nav * {
    font-size: 48px !important;
    font-weight: 600 !important;
  }

  /* Ba≈ülƒ±k satƒ±rƒ± ‚ÄúDual AI Console ‚Äî Zero@Ecosystem‚Äù */
  h1, .title, .header-title {
    font-size: 58px !important;
    font-weight: 700 !important;
  }

  /* Model se√ßiciler (gpt-4.1 mini, Sonnet 4.5, vb.) */
  .model-chip, .model-selector, .chip, .badge, .tag {
    font-size: 40px !important;
    padding: 12px 28px !important;
    font-weight: 600 !important;
  }

  /* Textarea giri≈ü alanƒ± */
  textarea, .prompt-input {
    font-size: 50px !important;    /* √∂nceki boyutun 2√ó‚Äôi */
    line-height: 1.9 !important;
    padding: 22px !important;
    font-family: var(--base-font) !important;
  }

  textarea::placeholder {
    font-size: 46px !important;    /* üî• ‚ÄúCevap burada g√∂r√ºnecek‚Ä¶‚Äù i√ßin 2√ó */
    color: #777 !important;
  }

  /* Cevap kutularƒ± (ChatGPT & Claude) */
  #openai-output,
  #anthropic-output,
  .response-box,
  .output-box,
  pre, code {
    font-size: 50px !important;   /* üî• iki taraf da devasa ve e≈üit */
    line-height: 1.9 !important;
    white-space: pre-wrap !important;
    font-family: var(--base-font) !important;
  }

  /* Claude tarafƒ±nƒ±n placeholder‚Äôƒ± */
  .claude-placeholder, #claude-output::before {
    font-size: 46px !important;
  }

  /* Butonlar */
  button {
    font-size: 38px !important;
    padding: 18px 30px !important;
    font-weight: 600 !important;
  }
</style>
<!-- /GLOBAL SUPER FONT OVERRIDE -->


<!-- CLAUDE PLACEHOLDER + TOKENS FONT FIX -->
<style>
  /* Claude tarafƒ± √ßƒ±ktƒ± alanƒ± + placeholder */
  #anthropic-output,
  #anthropic-output * {
    font-size: 32px !important;
    line-height: 1.7 !important;
    color: #111 !important;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text",
                 "Helvetica Neue", Helvetica, Arial, sans-serif !important;
  }

  /* Ortak placeholder metinleri (her iki taraf i√ßin de) */
  .output-placeholder,
  .placeholder-text {
    font-size: 32px !important;
    color: #555 !important;
  }

  /* File upload ve Tokens satƒ±rƒ± */
  small,
  .token-info,
  .token-count,
  .tokens-label {
    font-size: 24px !important;
    line-height: 1.5 !important;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text",
                 "Helvetica Neue", Helvetica, Arial, sans-serif !important;
  }

  /* √ñzellikle dosya se√ßim label‚Äôƒ± */
  label[for*="file"],
  .file-label {
    font-size: 24px !important;
    font-weight: 500 !important;
  }
</style>
<!-- /CLAUDE PLACEHOLDER + TOKENS FONT FIX -->


<style>
  .copy-toolbar {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin: 12px 0 4px 0;
  }
  .copy-btn {
    background: #f9ba00;
    color: #000000;
    border: none;
    border-radius: 999px;
    padding: 8px 18px;
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 2px 4px rgba(0,0,0,0.14);
    transition: transform 0.05s ease, box-shadow 0.05s ease, opacity 0.1s ease;
  }
  .copy-btn:hover {
    opacity: 0.9;
    transform: translateY(-1px);
    box-shadow: 0 3px 6px rgba(0,0,0,0.18);
  }
</style>

</head>
<body>
<header>
  <div>
    <h1>Dual AI Console ‚Äî Zero@Ecosystem</h1>
    <span>Left: ChatGPT/OpenAI ¬∑ Right: Claude (Anthropic)</span>
  </div>
  <span>Local ¬∑ Pay-as-you-go via API keys</span>
</header>

<div class="copy-toolbar">
  <button class="copy-btn" onclick="copyPromptLeftToRight()">Copy ‚Üí Claude</button>
  <button class="copy-btn" onclick="copyPromptRightToLeft()">Copy ‚Üí ChatGPT</button>
</div>

<main>
  <!-- LEFT PANEL: OPENAI / CHATGPT -->
  <section class="panel" id="openai-panel">
    <div class="panel-header">
      <h2>üß° ChatGPT / OpenAI <span class="badge">gpt-4.1 / mini</span></h2>
      <select id="openai-model">
        <option value="gpt-4.1-mini">gpt-4.1-mini</option>
        <option value="gpt-4.1">gpt-4.1</option>
      </select>
    </div>
    <div class="body">
      <textarea id="openai-input" placeholder="Buraya bana soracaƒüƒ±n ≈üeyi yaz... (solda Chatty / OpenAI tarafƒ±)"></textarea>
      <div class="controls">
        <button id="openai-send">Send to OpenAI</button>
        <input type="file" id="openai-file" multiple />
        <span class="usage" id="openai-usage">Tokens: -</span>
      </div>
      <div class="output" id="openai-output">Cevap burada g√∂r√ºnecek...</div>
    </div>
  </section>

  <!-- RIGHT PANEL: CLAUDE -->
  <section class="panel" id="claude-panel">
    <div class="panel-header">
      <h2>üíô Claude / Anthropic <span class="badge">Sonnet / Opus / Haiku</span></h2>
      <select id="claude-model">
        <option value="claude-sonnet-4-5-20250929">Sonnet 4.5</option>
        <option value="claude-opus-4-5-20251101">Opus 4.5</option>
        <option value="claude-haiku-4-5-20251001">Haiku 4.5</option>
      </select>
    </div>
    <div class="body">
      <textarea id="claude-input" placeholder="Buraya Claude tarafƒ±na soracaƒüƒ±n ≈üeyi yaz... (saƒüda strateji / analiz / kod vs.)"></textarea>
      <div class="controls">
        <button id="claude-send">Send to Claude</button>
        <input type="file" id="claude-file" multiple />
        <span class="usage" id="claude-usage">Tokens: -</span>
      </div>
      <div class="output" id="claude-output">Cevap burada g√∂r√ºnecek...</div>
    </div>
  </section>
</main>
<footer>
  <span>Tip: Aynƒ± promptu iki tarafa da g√∂nderip cevaplarƒ± kƒ±yaslayabilirsin.</span>
  <span>Zero@Ecosystem ¬∑ Local Dev Console</span>
</footer>

<script>
async function sendChat(side) {
  const inputEl = document.getElementById(side + "-input");
  const outputEl = document.getElementById(side + "-output");
  const usageEl = document.getElementById(side + "-usage");
  const modelEl = document.getElementById(side + "-model");
  const fileEl = document.getElementById(side + "-file");
  const btnEl = document.getElementById(side + "-send");

  const prompt = inputEl.value.trim();
  if (!prompt) return;

  const model = modelEl.value;
  const endpoint = side === "openai" ? "/api/chat/openai" : "/api/chat/claude";

  const formData = new FormData();
  formData.append("prompt", prompt);
  formData.append("model", model);
  formData.append("max_tokens", "600");

  if (fileEl.files && fileEl.files.length > 0) {
    for (const f of fileEl.files) {
      formData.append("files", f);
    }
  }

  btnEl.disabled = true;
  btnEl.textContent = "Working...";
  outputEl.textContent = "Thinking...";

  try {
    const res = await fetch(endpoint, {
      method: "POST",
      body: formData,
    });

    if (!res.ok) {
      const errText = await res.text();
      outputEl.textContent = "Error: " + errText;
      usageEl.textContent = "Tokens: error";
      return;
    }

    const data = await res.json();
    if (data.error) {
      outputEl.textContent = "Error: " + data.error;
      usageEl.textContent = "Tokens: error";
      return;
    }

    outputEl.textContent = data.answer || "(bo≈ü cevap)";
    const usage = data.usage || {};
    const inTok = usage.input_tokens ?? usage.prompt_tokens ?? "-";
    const outTok = usage.output_tokens ?? usage.completion_tokens ?? "-";
    usageEl.textContent = `Tokens ‚Üí in: ${inTok} ¬∑ out: ${outTok}`;
  } catch (e) {
    outputEl.textContent = "Error: " + e;
    usageEl.textContent = "Tokens: error";
  } finally {
    btnEl.disabled = false;
    btnEl.textContent = side === "openai" ? "Send to OpenAI" : "Send to Claude";
  }
}

document.getElementById("openai-send").addEventListener("click", () => sendChat("openai"));
document.getElementById("claude-send").addEventListener("click", () => sendChat("claude"));

document.getElementById("openai-input").addEventListener("keydown", (e) => {
  if (e.key === "Enter" && (e.metaKey || e.ctrlKey)) {
    e.preventDefault();
    sendChat("openai");
  }
});
document.getElementById("claude-input").addEventListener("keydown", (e) => {
  if (e.key === "Enter" && (e.metaKey || e.ctrlKey)) {
    e.preventDefault();
    sendChat("claude");
  }
});
</script>

<!-- PROJECT_HISTORY_START -->
<style>
  #project-history {
    display: flex;
    gap: 24px;
    padding: 10px 16px;
    border-bottom: 1px solid #222;
    background: #05070b;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
    position: sticky;
    top: 0;
    z-index: 50;
  }
  .history-column {
    flex: 1;
  }
  .history-column h3 {
    font-size: 13px;
    margin: 0 0 6px 0;
    color: #aaa;
    text-transform: uppercase;
    letter-spacing: 0.06em;
  }
  .history-column ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
  }
  .history-column li {
    display: flex;
    align-items: center;
  }
  .history-pill {
    font-size: 12px;
    padding: 4px 10px;
    border-radius: 999px;
    border: 1px solid #333;
    background: #111;
    color: #eee;
    cursor: pointer;
    white-space: nowrap;
  }
  .history-pill:hover {
    border-color: #f9ba00;
  }
  .history-link {
    margin-left: 4px;
    font-size: 11px;
    color: #888;
    text-decoration: none;
  }
  .history-link:hover {
    color: #f9ba00;
  }
  @media (max-width: 900px) {
    #project-history {
      flex-direction: column;
      gap: 12px;
    }
  }
</style>

<div id="project-history">
  <div class="history-column">
    <h3>ChatGPT Projects</h3>
    <ul id="openai-history-list"></ul>
  </div>
  <div class="history-column">
    <h3>Claude Projects</h3>
    <ul id="claude-history-list"></ul>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', async () => {
  try {
    const res = await fetch('/static/history.json');
    if (!res.ok) throw new Error('HTTP ' + res.status);
    const data = await res.json();

    const openaiList = document.getElementById('openai-history-list');
    const claudeList = document.getElementById('claude-history-list');

    function addItem(item, parent) {
      const li = document.createElement('li');

      const btn = document.createElement('button');
      btn.className = 'history-pill';
      btn.textContent = item.label;
      btn.onclick = () => {
        if (item.url) {
          window.open(item.url, '_blank', 'noopener,noreferrer');
        }
      };

      li.appendChild(btn);

      if (item.url) {
        const a = document.createElement('a');
        a.className = 'history-link';
        a.href = item.url;
        a.target = '_blank';
        a.rel = 'noopener noreferrer';
        a.textContent = '‚Üó';
        li.appendChild(a);
      }

      parent.appendChild(li);
    }

    (data.openai || []).forEach(it => addItem(it, openaiList));
    (data.claude || []).forEach(it => addItem(it, claudeList));
  } catch (err) {
    console.error('Project history load error:', err);
  }
});
</script>
<!-- PROJECT_HISTORY_END -->

</body>
</html>
